// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("MYSQL_DATABASE_URL")
}

model user {
  id                    String         @id @default(cuid())
  email                 String         @unique @db.VarChar(100)
  pseudo                String         @unique @db.VarChar(30)
  profilePicture        String?        @default("default") @db.VarChar(255)
  password              String         @db.VarChar(255)
  role                  RoleEnum       @default(USER)
  resetPasswordCode     String?        @db.VarChar(255)
  resetPasswordCodeDate Int?           @db.Int()
  createdAt             DateTime       @default(now())
  updatedAt             DateTime       @updatedAt
  user_setting          user_setting[]
  game                  game[]
  game_advice           game_advice[]
}

model setting {
  id           String         @id @default(cuid())
  name         String         @unique @db.VarChar(50)
  user_setting user_setting[]
}

model user_setting {
  id_user    String
  id_setting String
  user       user    @relation(fields: [id_user], references: [id])
  setting    setting @relation(fields: [id_setting], references: [id])

  @@id([id_user, id_setting])
}

model game {
  id            String          @id @default(cuid())
  id_user       String
  user          user            @relation(fields: [id_user], references: [id])
  name          String          @db.VarChar(50)
  logo          String          @db.VarChar(255)
  description   String          @db.Text()
  releaseDate   DateTime
  createdAt     DateTime        @default(now())
  game_category game_category[]
  game_platform game_platform[]
  media         media[]
  game_advice   game_advice[]
}

model game_advice {
  id_game String
  id_user String
  advice  String @db.Text()
  note    Int
  game    game   @relation(fields: [id_game], references: [id])
  user    user   @relation(fields: [id_user], references: [id])

  @@id([id_game, id_user])
}

model game_category {
  id_game     String
  id_category String
  game        game     @relation(fields: [id_game], references: [id])
  category    category @relation(fields: [id_category], references: [id])

  @@id([id_game, id_category])
}

model category {
  id            String          @id @default(cuid())
  name          String          @unique @db.VarChar(50)
  game_category game_category[]
}

model game_platform {
  id_game     String
  id_platform String
  game        game     @relation(fields: [id_game], references: [id])
  platform    platform @relation(fields: [id_platform], references: [id])

  @@id([id_game, id_platform])
}

model platform {
  id            String          @id @default(cuid())
  name          String          @unique @db.VarChar(50)
  game_platform game_platform[]
}

model media {
  id      String    @id @default(cuid())
  id_game String
  type    MediaEnum @default(IMAGE)
  path    String    @db.VarChar(255)
  game    game      @relation(fields: [id_game], references: [id])
}

enum RoleEnum {
  ADMIN
  MODERATOR
  USER
}

enum MediaEnum {
  IMAGE
  VIDEO
}
